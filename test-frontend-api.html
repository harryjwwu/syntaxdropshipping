<!DOCTYPE html>
<html>
<head>
    <title>å‰ç«¯APIæµ‹è¯•</title>
</head>
<body>
    <h1>å‰ç«¯APIæµ‹è¯•</h1>
    <div id="results"></div>
    
    <script>
        const API_BASE = 'http://localhost:5001/api'\;
        const results = document.getElementById('results');
        
        function log(message) {
            results.innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }
        
        async function testAPI() {
            try {
                // 1. æµ‹è¯•ç™»å½•
                log('ğŸ” æµ‹è¯•ç®¡ç†å‘˜ç™»å½•...');
                const loginResponse = await fetch(`${API_BASE}/admin/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: 'admin@syntaxdropshipping.com',
                        password: 'admin123456'
                    })
                });
                
                const loginData = await loginResponse.json();
                
                if (loginData.success) {
                    const token = loginData.token;
                    log('âœ… ç™»å½•æˆåŠŸï¼ŒToken: ' + token.substring(0, 20) + '...');
                    
                    // 2. æµ‹è¯•SPUåˆ—è¡¨API
                    log('ğŸ“‹ æµ‹è¯•SPUåˆ—è¡¨API...');
                    const spuResponse = await fetch(`${API_BASE}/admin/spus?limit=1000`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    log('SPU APIçŠ¶æ€ç : ' + spuResponse.status);
                    
                    if (spuResponse.ok) {
                        const spuData = await spuResponse.json();
                        log('âœ… SPU APIæˆåŠŸ: ' + JSON.stringify(spuData).substring(0, 100) + '...');
                    } else {
                        const errorText = await spuResponse.text();
                        log('âŒ SPU APIå¤±è´¥: ' + errorText);
                    }
                    
                    // 3. æµ‹è¯•COSé…ç½®API
                    log('ğŸŒ æµ‹è¯•COSé…ç½®API...');
                    const cosResponse = await fetch(`${API_BASE}/cos/config`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    log('COS APIçŠ¶æ€ç : ' + cosResponse.status);
                    
                    if (cosResponse.ok) {
                        const cosData = await cosResponse.json();
                        log('âœ… COS APIæˆåŠŸ: ' + JSON.stringify(cosData));
                    } else {
                        const errorText = await cosResponse.text();
                        log('âŒ COS APIå¤±è´¥: ' + errorText);
                    }
                    
                } else {
                    log('âŒ ç™»å½•å¤±è´¥: ' + loginData.message);
                }
                
            } catch (error) {
                log('âŒ æµ‹è¯•å‡ºé”™: ' + error.message);
            }
        }
        
        // å¯åŠ¨æµ‹è¯•
        testAPI();
    </script>
</body>
</html>
